<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Coprime Nim</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>
<body>
<div id="container">
<div class="center print"></div>
<h2>Coprime Nim</h2><div id="problem_info"><h3>Problem 560</h3></div>
<div class="problem_content" role="problem">
<p>Coprime Nim is just like ordinary normal play Nim, but the players may only remove a number of stones from a pile  that is <b>coprime</b> with the current size of the pile. Two players remove stones in turn. The player who removes the last stone wins.</p>

<p>Let L(<var>n</var>,&nbsp;<var>k</var>) be the number of <b>losing</b> starting positions for the first player, assuming perfect play, when the game is played with <var>k</var> piles, each having between 1 and <var>n</var>&nbsp;-&nbsp;1 stones inclusively.</p>

<p>For example, L(5,&nbsp;2)&nbsp;=&nbsp;6 since the losing initial positions are (1,&nbsp;1), (2,&nbsp;2), (2,&nbsp;4), (3,&nbsp;3), (4,&nbsp;2) and (4,&nbsp;4).<br>
You are also given L(10,&nbsp;5)&nbsp;=&nbsp;9964, L(10,&nbsp;10)&nbsp;=&nbsp;472400303, L(10<sup>3</sup>,&nbsp;10<sup>3</sup>)&nbsp;mod&nbsp;1&nbsp;000&nbsp;000&nbsp;007&nbsp;=&nbsp;954021836.</p>

<p>Find L(10<sup>7</sup>,&nbsp;10<sup>7</sup>)&nbsp;mod&nbsp;1&nbsp;000&nbsp;000&nbsp;007</p>

</div><br>
<br>
</div>
</body>
</html>
